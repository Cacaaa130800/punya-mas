<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mood Tracker Mas ğŸ’™</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js">

/* ===== EXTRA FEATURES PACK ğŸ’™===== */

/* === MODE JEALOUS ğŸ˜¤ğŸ’— === */
let jealous = false;
const jealousBtn = document.createElement('button');
jealousBtn.textContent = 'ğŸ˜¤ Mode Jealous';
jealousBtn.className = 'btn';
jealousBtn.style.margin = '10px';
jealousBtn.onclick = () => {
  jealous = !jealous;
  if (jealous) {
    document.body.style.background = '#ffe6e6';
    document.body.style.color = '#5a0000';
    showBubble('mas lagi jealous ya?? sini caca pelukkk ğŸ˜¤ğŸ’—');
  } else {
    document.body.style.background = '';
    document.body.style.color = '';
  }
};
document.body.insertBefore(jealousBtn, document.body.children[3]);

/* === RANDOM STICKER POP === */
const stickerList = [
  'https://i.imgur.com/cy7Q5pA.png',
  'https://i.imgur.com/6XH8O1g.png',
  'https://i.imgur.com/OeQO3ZN.png'
];
setInterval(() => {
  const img = document.createElement('img');
  img.src = stickerList[Math.floor(Math.random()*stickerList.length)];
  img.style.position='fixed'; img.style.left=Math.random()*80+'vw'; img.style.top='-30px';
  img.style.width='90px'; img.style.transition='3s'; img.style.zIndex='99999';
  document.body.appendChild(img);
  setTimeout(()=>{ img.style.top='100vh'; img.style.opacity='0'; },50);
  setTimeout(()=>img.remove(),3000);
}, 4000);

/* === SAKURA PETALS EFFECT === */
setInterval(()=>{
  const p=document.createElement('div');
  p.textContent='ğŸŒ¸';
  p.style.position='fixed';
  p.style.left=Math.random()*100+'vw';
  p.style.top='-20px';
  p.style.fontSize='20px';
  p.style.transition='4s linear';
  document.body.appendChild(p);
  setTimeout(()=>{ p.style.top='100vh'; p.style.opacity='0'; },20);
  setTimeout(()=>p.remove(),4000);
},1000);

/* === VOICE BUBBLE === */
function voiceBubble(text){
  const b=document.createElement('div');
  b.textContent=text;
  b.style.position='fixed'; b.style.left='20px'; b.style.top='20px';
  b.style.padding='12px 16px'; b.style.background='#fff6b8';
  b.style.borderRadius='12px'; b.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)';
  b.style.zIndex='99999'; b.style.opacity='1'; b.style.transition='1.5s';
  document.body.appendChild(b);
  setTimeout(()=>b.style.opacity='0',1500);
  setTimeout(()=>b.remove(),2500);
}

setInterval(()=>{
  const lines=[
    'mas lagi ngapain siiihh ğŸ¥ºğŸ’™',
    'caca liat mas dari sini ğŸ˜³',
    'mas jangan lupa minummm ğŸ©µ',
    'caca kangen mas ğŸ˜­ğŸ’™'
  ];
  voiceBubble(lines[Math.floor(Math.random()*lines.length)]);
}, 15000);

/* === EXP LOVE SYSTEM === */
let exp = parseInt(localStorage.getItem('loveEXP') || '0');
function addEXP(){
  exp += 5;
  localStorage.setItem('loveEXP', exp);
  showBubble('â¤ï¸ LOVE EXP +5 (Total: '+exp+')');
}

// add exp when mood clicked
moodButtons.forEach(btn=>{
  btn.addEventListener('click',()=>addEXP());
});

// add exp on note
const originalSave = saveNote;
saveNote = function(){ originalSave(); addEXP(); };



/* ============================================= */
/*         âœ¨ SUPER CUTE UPDATE PART 2 âœ¨         */
/* ============================================= */

/* === FEATURE 8: MODE MARAH PETIR âš¡ğŸ˜¡ === */
let marahMode = false;
const marahBtn = document.createElement('button');
marahBtn.textContent = 'âš¡ Mode Marah';
marahBtn.className = 'btn';
marahBtn.style.margin = '10px';
marahBtn.onclick = () => {
  marahMode = !marahMode;
  if (marahMode) {
    document.body.style.background = '#ffdbdb';
    showBubble('mas lagi marahh?? caca disiniiiiii, bakal peluk mas kuat kuatttttt ğŸ˜­ğŸ’™');
    startLightning();
  } else {
    stopLightning();
    document.body.style.background = '';
  }
};
document.body.insertBefore(marahBtn, document.body.children[4]);

let lightningInterval;
function startLightning(){
  lightningInterval = setInterval(()=>{
    const flash = document.createElement('div');
    flash.style.position='fixed'; flash.style.inset='0';
    flash.style.background='rgba(255,255,255,0.7)';
    flash.style.opacity='1'; flash.style.transition='0.2s';
    flash.style.zIndex='999999';
    document.body.appendChild(flash);
    setTimeout(()=>flash.style.opacity='0',50);
    setTimeout(()=>flash.remove(),200);
  },1200);
}
function stopLightning(){ clearInterval(lightningInterval); }


/* === FEATURE 9: MODE NGANTUK ğŸ˜´âœ¨ === */
let sleepy = false;
const sleepyBtn = document.createElement('button');
sleepyBtn.textContent = 'ğŸ˜´ Mode Ngantuk';
sleepyBtn.className = 'btn';
sleepyBtn.style.margin = '10px';
sleepyBtn.onclick = ()=>{
  sleepy = !sleepy;
  if(sleepy){
    document.body.style.filter='brightness(0.8)';
    showBubble('mas ngantuk ya? caca temenin boboooo ğŸ©µğŸ˜´');
    startZZZ();
  } else {
    stopZZZ(); document.body.style.filter='';
  }
};
document.body.insertBefore(sleepyBtn, document.body.children[5]);

let zzzInterval;
function startZZZ(){
  zzzInterval = setInterval(()=>{
    const z=document.createElement('div');
    z.textContent='ğŸ’¤';
    z.style.position='fixed'; z.style.left=Math.random()*100+'vw';
    z.style.top='-10px'; z.style.fontSize='22px';
    z.style.transition='3s linear';
    document.body.appendChild(z);
    setTimeout(()=>{ z.style.top='100vh'; z.style.opacity='0'; },20);
    setTimeout(()=>z.remove(),3000);
  },800);
}
function stopZZZ(){ clearInterval(zzzInterval); }


/* === FEATURE 10: GACHA STICKER ğŸğŸ©µ === */
const gachaBtn = document.createElement('button');
gachaBtn.textContent = 'ğŸ Gacha Stiker';
gachaBtn.className = 'btn';
gachaBtn.style.margin = '10px';
gachaBtn.onclick = ()=>{
  const gachabox = document.createElement('div');
  gachabox.style.position='fixed'; gachabox.style.inset='0';
  gachabox.style.background='rgba(0,0,0,0.6)';
  gachabox.style.display='flex'; gachabox.style.flexDirection='column';
  gachabox.style.justifyContent='center'; gachabox.style.alignItems='center';
  gachabox.style.zIndex='99999';

  const s = stickerList[Math.floor(Math.random()*stickerList.length)];
  const img = document.createElement('img');
  img.src = s;
  img.style.width='200px'; img.style.borderRadius='12px';
  img.style.boxShadow='0 6px 18px rgba(0,0,0,0.4)';

  const msg = document.createElement('p');
  msg.textContent='mas dapet stiker lucuuu ğŸ©µ';
  msg.style.color='white'; msg.style.marginTop='10px';

  const close = document.createElement('button');
  close.textContent='tutup';
  close.className='btn';
  close.style.marginTop='10px';
  close.onclick=()=>gachabox.remove();

  gachabox.appendChild(img);
  gachabox.appendChild(msg);
  gachabox.appendChild(close);
  document.body.appendChild(gachabox);
};
document.body.insertBefore(gachaBtn, document.body.children[6]);


/* === FEATURE 11: LOVE LEVEL BADGES â¤ï¸ğŸ… === */
function updateLoveBadge(){
  const level = exp;
  let badge = '';
  if(level < 50) badge = 'ğŸ’— Baby Love';
  else if(level < 150) badge = 'ğŸ’ Sweetheart';
  else if(level < 300) badge = 'ğŸ’˜ Lover Lv.3';
  else badge = 'ğŸ’ Soulmate Max';

  let badgeBox = document.getElementById('loveBadge');
  if(!badgeBox){
    badgeBox = document.createElement('div');
    badgeBox.id='loveBadge';
    badgeBox.style.margin='10px';
    badgeBox.style.fontSize='20px';
    badgeBox.style.fontWeight='bold';
    badgeBox.style.textAlign='center';
    document.body.insertBefore(badgeBox, document.body.children[1]);
  }
  badgeBox.textContent = 'â¤ï¸ Love Level: ' + badge;
}
updateLoveBadge();

// hook EXP update
const EXPoriginal = addEXP;
addEXP = function(){ EXPoriginal(); updateLoveBadge(); };



/* ================================================= */
/*            âœ¨ SUPER CUTE UPDATE PART 3 âœ¨          */
/* ================================================= */

/* === MODE MANJA ğŸ¥ºğŸ’— === */
let manja=false;
const manjaBtn=document.createElement('button');
manjaBtn.textContent='ğŸ° Mode Manja';
manjaBtn.className='btn';
manjaBtn.style.margin='10px';
manjaBtn.onclick=()=>{
  manja=!manja;
  if(manja){
    document.body.style.filter='saturate(1.4) brightness(1.1)';
    showBubble('mas lagi manja yaaa?? caca sukaaaaa ğŸ¥ºğŸ’—ğŸ°');
    startBlush();
  } else { stopBlush(); document.body.style.filter=''; }
};
document.body.insertBefore(manjaBtn, document.body.children[7]);

let blushInterval;
function startBlush(){
  blushInterval=setInterval(()=>{
    const b=document.createElement('div');
    b.textContent='ğŸ’•';
    b.style.position='fixed'; b.style.left=Math.random()*100+'vw';
    b.style.top='-20px'; b.style.fontSize='26px';
    b.style.transition='3s linear';
    document.body.appendChild(b);
    setTimeout(()=>b.style.top='100vh',20);
    setTimeout(()=>b.remove(),3000);
  },900);
}
function stopBlush(){ clearInterval(blushInterval); }


/* === MODE SEDIH ğŸŒ§ï¸ğŸ˜­ === */
let sedih=false;
const sedihBtn=document.createElement('button');
sedihBtn.textContent='ğŸŒ§ï¸ Mode Sedih';
sedihBtn.className='btn';
sedihBtn.style.margin='10px';
sedihBtn.onclick=()=>{
  sedih=!sedih;
  if(sedih){
    document.body.style.filter='grayscale(0.4)';
    showBubble('mas sedih yaaa?? ciniiiii caca peluk erattt ğŸ˜­ğŸ’™');
    startRain();
  } else { stopRain(); document.body.style.filter=''; }
};
document.body.insertBefore(sedihBtn, document.body.children[8]);

let rainInterval;
function startRain(){
  rainInterval=setInterval(()=>{
    const r=document.createElement('div');
    r.textContent='ğŸ’§';
    r.style.position='fixed'; r.style.left=Math.random()*100+'vw';
    r.style.top='-20px'; r.style.fontSize='18px';
    r.style.transition='2s linear';
    document.body.appendChild(r);
    setTimeout(()=>r.style.top='100vh',20);
    setTimeout(()=>r.remove(),2000);
  },120);
}
function stopRain(){ clearInterval(rainInterval); }


/* === MODE PROTEKTIF ğŸ”¥ğŸ›¡ï¸ === */
let protek=false;
const protekBtn=document.createElement('button');
protekBtn.textContent='ğŸ›¡ï¸ Mode Protektif';
protekBtn.className='btn';
protekBtn.style.margin='10px';
protekBtn.onclick=()=>{
  protek=!protek;
  if(protek){
    showBubble('mas protektif ya?? cacaaa aman kok sama mas ğŸ˜³ğŸ›¡ï¸');
    startShield();
  } else stopShield();
};
document.body.insertBefore(protekBtn, document.body.children[9]);

let shieldInterval;
function startShield(){
  shieldInterval=setInterval(()=>{
    const s=document.createElement('div');
    s.textContent='ğŸ›¡ï¸';
    s.style.position='fixed'; s.style.left=(Math.random()*80+10)+'vw';
    s.style.top=(Math.random()*80+10)+'vh';
    s.style.fontSize='30px'; s.style.opacity='0';
    s.style.transition='1s';
    document.body.appendChild(s);
    setTimeout(()=>s.style.opacity='1',50);
    setTimeout(()=>s.remove(),1500);
  },500);
}
function stopShield(){ clearInterval(shieldInterval); }


/* === LOVE EXPLOSION (tiap EXP kelipatan 50) ğŸ’¥ğŸ’— === */
function loveExplosion(){
  for(let i=0;i<20;i++){
    const h=document.createElement('div');
    h.textContent='ğŸ’—';
    h.style.position='fixed';
    h.style.left='50vw'; h.style.top='50vh';
    h.style.fontSize='24px';
    h.style.transition='1.2s';
    let angle=Math.random()*360;
    h.style.transform=`translate(0px,0px)`;
    document.body.appendChild(h);
    setTimeout(()=>{
      h.style.transform=`translate(${Math.cos(angle)*200}px,${Math.sin(angle)*200}px)`;
      h.style.opacity='0';
    },20);
    setTimeout(()=>h.remove(),1200);
  }
}

const oldAddEXP = addEXP;
addEXP = function(){
  oldAddEXP();
  if(exp % 50 === 0) loveExplosion();
};


/* === EVENT HARIAN ğŸ€ğŸ‰ === */
function showDailyQuest(){
  const quests=[
    'kirim mood jujur hari ini ğŸ©µ',
    'tulis satu kalimat buat caca ğŸ˜³ğŸ’—',
    'peluk caca 3x ğŸ¤—ğŸ¤—ğŸ¤—',
    'bilang â€œaku sayang cacaaaâ€ ğŸ˜­ğŸ’™',
    'kasih stiker favorit mas ğŸ©µ'
  ];
  const q=quests[Math.floor(Math.random()*quests.length)];

  const box=document.createElement('div');
  box.style.position='fixed'; box.style.inset='0';
  box.style.background='rgba(0,0,0,0.5)';
  box.style.display='flex'; box.style.flexDirection='column';
  box.style.justifyContent='center'; box.style.alignItems='center';
  box.style.zIndex='999999';

  const card=document.createElement('div');
  card.style.background='white';
  card.style.padding='20px';
  card.style.borderRadius='14px';
  card.style.textAlign='center';
  card.style.boxShadow='0 8px 20px rgba(0,0,0,0.3)';

  const t=document.createElement('h3');
  t.textContent='ğŸ€ Daily Quest Mas';
  const p=document.createElement('p');
  p.textContent=q;

  const ok=document.createElement('button');
  ok.className='btn';
  ok.textContent='oke cacaaaa ğŸ©µ';
  ok.onclick=()=>box.remove();

  card.appendChild(t); card.appendChild(p); card.appendChild(ok);
  box.appendChild(card);
  document.body.appendChild(box);
}

setTimeout(showDailyQuest, 2000);


/* === AI AUTO-REPLY to MOOD (super cute) ğŸ¤–ğŸ’™ === */
function aiReplyToMood(mood){
  const replies={
    'ğŸ˜„ Senang':'caca ikut seneng bangettt ğŸ˜­ğŸ’™ ayo kita rayain dikit yuk! âœ¨',
    'ğŸ™‚ Biasa aja':'ga papa mas, sini caca temenin biar hari mas lebih hangat ğŸ©µ',
    'ğŸ˜¢ Sedih':'mas sedih?? caca disini yaaa, nantiii aku peluk ampe tenang ğŸ˜­ğŸ¤',
    'ğŸ˜¡ Kesel':'siapa yang buat mas kesel?? ayoooo, kita cubit bareng barenggggg! ğŸ˜¤ğŸ’™',
    'ğŸ¥° Sayang Ca':'MAS SAYANG CACAA??? caca lebih sayang mas 10000x ğŸ˜­ğŸ’—'
  };
  showBubble(replies[mood] || 'caca ada buat mas ğŸ©µ');
}

const oldSaveMood = saveMood;
saveMood = function(mood){
  oldSaveMood(mood);
  aiReplyToMood(mood);
};

</script>
  <style>
    :root { --bg:#eaf3ff; --text:#1b2b3c; --card:#ffffff; --accent:#6fa8dc; }
    .dark { --bg:#0f1621; --text:#f1f6ff; --card:#1d2b40; --accent:#4a90e2; }

    body {
      font-family: Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: .3s;
    }

    .hidden { display:none; }

    /* GATE SCREEN */
    #gate {
      position: fixed;
      inset: 0;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 15px;
      z-index: 2000;
    }
    #gate input {
      padding: 10px;
      border-radius: 10px;
      border:1px solid #aaa;
    }
    
    h1 { margin-bottom: 10px; }

    .btn {
      padding: 8px 14px;
      border: none;
      border-radius: 10px;
      background: var(--accent);
      color: white;
      cursor: pointer;
      margin: 5px;
    }

    .mood-container { display:flex; gap:15px; margin:20px; flex-wrap:wrap; }
    .mood { font-size:38px; cursor:pointer; transition:.2s; }
    .mood:hover { transform:scale(1.18); }

    .card {
      background: var(--card);
      padding: 15px;
      width: 92%;
      max-width: 550px;
      border-radius: 12px;
      box-shadow: 0px 4px 12px rgba(0,0,0,0.1);
      margin-top: 20px;
    }

    textarea {
      width: 100%; height: 80px;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #aaa;
      background: var(--card);
      color: var(--text);
    }

    /* DELETE BUTTON */
    .deleteBtn {
      background:#ff6b6b; color:white; border:none; border-radius:6px;
      padding:3px 8px; margin-left:10px; cursor:pointer;
    }

    #sticker {
      position: fixed;
      right: 10px;
      bottom: 10px;
      width: 120px;
      opacity: 0;
      transform: translateY(20px);
      transition: .4s;
      z-index: 999;
    }

    #sticker.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* hearts */
    .loveHeart {
      position: fixed;
      font-size: 26px;
      animation: floatUp 2.3s ease-out;
      pointer-events:none;
      z-index: 9000;
    }

    @keyframes floatUp {
      0% { transform:translateY(0); opacity:1; }
      100% { transform:translateY(-150px); opacity:0; }
    }
  </style>
</head>
<body>

  <!-- GATE LOGIN CUTE ENTRY -->
  <div id="gate">
    <h2>ğŸ’™ Siapa kamu? ğŸ’™</h2>
    <p>Mas harus jawab duluuu~</p>
    <input id="gateInput" placeholder="ketik: mas" />
    <button class="btn" onclick="enterGate()">Masuk âœ</button>
    <div id="gateMsg" style="color:red"></div>
  </div>

  <h1>Mood Tracker Mas ğŸ’™</h1>

  <button class="btn" onclick="toggleDark()">ğŸŒ™ Dark/Light</button>
  <button class="btn" onclick="toggleMusic()">ğŸµ Music</button>

  <p>Pilih mood mas hari ini:</p>

  <div class="mood-container">
    <span class="mood" data-mood="ğŸ˜„ Senang">ğŸ˜„</span>
    <span class="mood" data-mood="ğŸ™‚ Biasa aja">ğŸ™‚</span>
    <span class="mood" data-mood="ğŸ˜¢ Sedih">ğŸ˜¢</span>
    <span class="mood" data-mood="ğŸ˜¡ Kesel">ğŸ˜¡</span>
    <span class="mood" data-mood="ğŸ¥° Sayang caca">ğŸ¥°</span>
  </div>

  <div id="reaction" style="font-size:18px; text-align:center; min-height:40px;"></div>

  <div class="card">
    <h3>Riwayat Mood</h3>
    <div id="entries" style="margin-top:12px"></div>
  </div>

  <div class="card">
    <h3>Mood Bulan Ini</h3>
    <p id="avgMood"></p>
    <canvas id="moodChart" height="150"></canvas>
  </div>

  <div class="card">
    <h3>Catatan dari mas:</h3>
    <textarea id="noteInput" placeholder="Mas mau nulis apa ke caca?"></textarea>
    <button class="btn" onclick="saveNote()">Simpan</button>
    <div id="notes" style="margin-top:10px"></div>
  </div>

  <img id="sticker" src="https://i.imgur.com/cy7Q5pA.png" />

  <audio id="bgm" loop>
    <source src="music.mp3" type="audio/mpeg" />
  </audio>

<script>

/* GATE */
function enterGate(mode){
  const val = document.getElementById('gateInput').value.trim().toLowerCase();
  const msg = document.getElementById('gateMsg');

  // mode â€œsurpriseâ€
  if(mode === 'surprise'){
    document.getElementById('gate').style.display = 'none';
    showBubble('surprise buat mas ğŸ©µ');
    return;
  }

  // mode normal (jawaban harus "mas")
  if(val === 'mas'){
    document.getElementById('gate').style.opacity = '0';

    // animasi fade out biar halus
    setTimeout(()=>{
      document.getElementById('gate').style.display = 'none';
    }, 400);

    showBubble('Halo mas ğŸ©µ masuk sini yaa~');
  } 
  else {
    msg.textContent = 'jawabannya salah ğŸ˜¡ cuma mas yang boleh masuk!';
  }
}


function toggleDark(){ document.body.classList.toggle('dark'); }
function toggleMusic(){ const m=document.getElementById('bgm'); m.paused?m.play():m.pause(); }

const moodButtons=document.querySelectorAll('.mood');
const reaction=document.getElementById('reaction');
const sticker=document.getElementById('sticker');
let moodChart;

const reactions={
  'ğŸ˜„ Senang':'mas seneng?? caca ikut seneng banget ğŸ˜­ğŸ’™',
  'ğŸ™‚ Biasa aja':'hari ini biasa aja ya mas? sini caca temenin ğŸ©µ',
  'ğŸ˜¢ Sedih':'mas sedihhh? sini aku pelukkkkk ğŸ˜­ğŸ©µ',
  'ğŸ˜¡ Kesel':'siapa yang bikin mas kesel?? caca cubit tuh orang ğŸ˜¤ğŸ’™',
  'ğŸ¥° Sayang caca':'mas sayang cacaaa?? cacaaa juga sayang mas banyak banyakkkkkk ğŸ¥¹ğŸ’™'
};

moodButtons.forEach(btn=>{
  btn.addEventListener('click',()=>{
    const mood=btn.dataset.mood;
    const date=new Date().toLocaleString();

    let logs=JSON.parse(localStorage.getItem('masMoodLog')||'[]');
    logs.unshift({mood,date});
    localStorage.setItem('masMoodLog',JSON.stringify(logs));

    showReaction(mood);
    renderLogs();
    spawnHearts();
    showSticker();
    updateChart();
    calcAverage();
  });
});

function showReaction(mood){ reaction.textContent=reactions[mood]||''; }

function showSticker(){
  sticker.classList.add('show');
  setTimeout(()=>sticker.classList.remove('show'),2500);
}

function spawnHearts(){
  for(let i=0;i<6;i++){
    const h=document.createElement('div');
    h.className='loveHeart';
    h.textContent='ğŸ’™';
    h.style.left=Math.random()*90+'vw';
    h.style.bottom='-10px';
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),2300);
  }
}

function renderLogs(){
  const box=document.getElementById('entries');
  let logs=JSON.parse(localStorage.getItem('masMoodLog')||'[]');
  box.innerHTML='';

  logs.forEach((l,index)=>{
    const d=document.createElement('div');
    d.innerHTML=`${l.date} â€” ${l.mood} <button class='deleteBtn' onclick='deleteMood(${index})'>hapus</button>`;
    box.appendChild(d);
  });
}

function deleteMood(i){
  let logs=JSON.parse(localStorage.getItem('masMoodLog')||'[]');
  logs.splice(i,1);
  localStorage.setItem('masMoodLog',JSON.stringify(logs));
  renderLogs(); updateChart(); calcAverage();
}

/* NOTES */
function saveNote(){
  const text=document.getElementById('noteInput').value.trim(); if(!text) return;
  let notes=JSON.parse(localStorage.getItem('masNotes')||'[]');
  notes.unshift({text,time:new Date().toLocaleString()});
  localStorage.setItem('masNotes',JSON.stringify(notes));
  document.getElementById('noteInput').value='';
  renderNotes();
}

function renderNotes(){
  const box=document.getElementById('notes');
  let notes=JSON.parse(localStorage.getItem('masNotes')||'[]');
  box.innerHTML='';
  notes.forEach(n=>{
    const d=document.createElement('div');
    d.textContent=`${n.time} â€” ${n.text}`;
    box.appendChild(d);
  });
}

/* MONTHLY AVG */
function calcAverage(){
  let logs=JSON.parse(localStorage.getItem('masMoodLog')||'[]');
  if(logs.length===0){ document.getElementById('avgMood').textContent='Belum ada mood'; return; }

  const score={
    'ğŸ˜„ Senang':5,
    'ğŸ™‚ Biasa aja':3,
    'ğŸ˜¢ Sedih':1,
    'ğŸ˜¡ Kesel':2,
    'ğŸ¥° Sayang caca':4
  };

  let total=0;
  logs.forEach(l=> total+=score[l.mood]||0);
  let avg=(total/logs.length).toFixed(2);

  let moodText='';
  if(avg>=4.5) moodText='Mas happy banget bulan ini ğŸ¥°ğŸ’™';
  else if(avg>=3) moodText='Mood mas lumayan stabil bulan ini ğŸ©µ';
  else moodText='Mas lagi butuh banyak peluk kayaknya ğŸ˜­ğŸ’™';

  document.getElementById('avgMood').textContent=`Rata-rata mood: ${avg} â€” ${moodText}`;
}

/* CHART */
function updateChart(){
  let logs=JSON.parse(localStorage.getItem('masMoodLog')||'[]');
  const labels=['ğŸ˜„ Senang','ğŸ™‚ Biasa aja','ğŸ˜¢ Sedih','ğŸ˜¡ Kesel','ğŸ¥° Sayang caca'];
  const counts=labels.map(m=>logs.filter(l=>l.mood===m).length);

  const ctx=document.getElementById('moodChart').getContext('2d');
  if(moodChart) moodChart.destroy();

  moodChart=new Chart(ctx,{
    type:'bar',
    data:{ labels, datasets:[{ data:counts, backgroundColor:['#7fc8ff','#a6d4ff','#b8b4ff','#d7d1ff','#ffb6d5'] }]},
    options:{ plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true}} }
  });
}

renderLogs();
renderNotes();
updateChart();
calcAverage();

</script>


<!-- SPARKLE ANIMATION CONTAINER -->
<div id="sparkleContainer"></div>

<!-- PELUK BUTTON FIXED -->
<button id="hugButton" class="btn" style="position:fixed; left:10px; bottom:10px; background:#ff8ac8; z-index:9999;">ğŸ¤— Kirim peluk ke Caca</button>

<script>

/* ====== SPARKLE EFFECT ====== */
setInterval(()=>{
  const s=document.createElement('div');
  s.textContent='âœ¨';
  s.style.position='fixed';
  s.style.left=Math.random()*100+'vw';
  s.style.top='-10px';
  s.style.fontSize=(14+Math.random()*10)+'px';
  s.style.opacity='1';
  s.style.transition='3s linear';
  document.body.appendChild(s);
  setTimeout(()=>{ s.style.top='100vh'; s.style.opacity='0'; },50);
  setTimeout(()=>s.remove(),3000);
}, 500);

/* ====== NOTIF BUBBLE CUTE ====== */
function showBubble(msg){
  const b=document.createElement('div');
  b.textContent=msg;
  b.style.position='fixed';
  b.style.right='20px';
  b.style.bottom='20px';
  b.style.padding='10px 14px';
  b.style.background='#ffb7e6';
  b.style.color='#000';
  b.style.borderRadius='12px';
  b.style.boxShadow='0 4px 10px rgba(0,0,0,0.2)';
  b.style.opacity='1';
  b.style.transition='1s';
  b.style.zIndex='99999';
  document.body.appendChild(b);
  setTimeout(()=>b.style.opacity='0',2000);
  setTimeout(()=>b.remove(),3000);
}

/* Trigger bubble on note save */
const originalSaveNote = saveNote;
saveNote = function(){
  originalSaveNote();
  showBubble('Catatan mas udah caca simpen ğŸ©µ');
};

/* ====== MODE KANGEN ====== */
let kangen=false;
const kangenBtn=document.createElement('button');
kangenBtn.textContent='ğŸ¥º Mode Kangen';
kangenBtn.className='btn';
kangenBtn.style.margin='10px';
kangenBtn.onclick=()=>{
  kangen=!kangen;
  if(kangen){
    document.body.style.filter='hue-rotate(300deg) brightness(1.2)';
    showBubble('mas lagi kangen cacaaa yaaa? ğŸ˜­ğŸ©µ');
  } else {
    document.body.style.filter='none';
  }
};
document.body.insertBefore(kangenBtn, document.body.children[2]);

/* ====== HUG BUTTON ====== */
document.getElementById('hugButton').addEventListener('click', ()=>{
  showBubble('caca dapet peluk dari mas ğŸ¤—ğŸ©µ');
  spawnHearts();
});

</script>

</body>
</html>
